$(function(a){function d(c,b){var e=c[b.field];return a("<a></a>").attr("href",e).attr("target","_blank").text(100>e.length?e:e.substring(0,100)+"...")}function f(){a("#delete-btn").toggleClass("disabled",0==a(".highlight").length)}a("[data-hide]").click(function(){a(this).closest("."+a(this).attr("data-hide")).addClass("hide")});a("#table-container").datatable({title:"",debug:!1,"class":"table",url:"/api/links",perPage:10,showPagination:!0,toggleColumns:!1,allowOverflow:!1,allowTableInfo:!1,filterModel:!1,
showPerPage:!1,columns:[{title:"ID",sortable:!1,field:"id",hidden:!0,callback:function(c,b){return a("<span></span>").attr("data-id",c[b.field])}},{title:"Short URL",sortable:!1,field:"short_url",callback:d},{title:"Original URL",sortable:!1,field:"url",callback:d},{title:"Created",sortable:!0,field:"created",callback:function(a,b){return moment.unix(a[b.field]).fromNow()}},{title:"Views",sortable:!0,field:"views",callback:function(a,b){return a[b.field].toString()}}],buttons:[a("<a></a>").attr("id",
"delete-btn").attr("title","Delete selected links").addClass("btn").addClass("disabled").append(a('<span class="glyphicon glyphicon-trash"></span>'))],rowCallback:function(a){return a},tableCallback:function(){function c(){a(".highlight").removeClass("highlight");b.render()}var b=this;f();a("table>tbody>tr>td").click(function(b){b.target==this&&(a(this).closest("tr").toggleClass("highlight"),f())});a("#delete-btn").off("click").on("click",function(){var b=[];a(".highlight span[data-id]").each(function(){b.push(a(this).attr("data-id"))});
var d=b.join("+");a.ajax({url:"/api/links/"+d,method:"DELETE",success:function(){a("#delete-alert").removeClass("hide");c();a("#delete-undo").off("click").on("click",function(){a.get("/api/links/restore/"+d).done(function(){c();a("#delete-alert").addClass("hide")})})}})})}})});
